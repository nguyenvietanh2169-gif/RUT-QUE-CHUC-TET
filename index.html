<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Quẻ Bính Ngọ 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --silk: #4e342e;
            --paper: #f2e8cf;
            --ink: #1a1a1a;
            --gold: #d4af37;
            --red-ancient: #8b0000;
        }

        body {
            margin: 0;
            background: #111 url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/IMG_6492.JPG?raw=true') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Segoe UI', serif;
        }

        body::before {
            content: "";
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        /* ỐNG QUẺ */
        #container {
            position: relative;
            width: 350px;
            height: 500px;
            z-index: 10;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }

        .cup-layer { position: absolute; bottom: 0; width: 100%; pointer-events: none; }
        #cup-back { z-index: 1; filter: brightness(0.4); }
        #cup-front { z-index: 5; filter: drop-shadow(0 15px 40px rgba(0,0,0,0.8)); }

        /* CỤM 8 CÂY QUẺ TO - CĂN GIỮA */
        .sticks-container {
            position: absolute;
            bottom: 210px;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            z-index: 3;
        }

        .stick-group {
            position: absolute;
            width: 28%; /* Quẻ to hơn */
            filter: brightness(0.85);
            transition: transform 0.1s;
            bottom: 0;
        }

        /* Hiệu ứng lắc dọc nhẹ nhàng */
        .shaking .stick-group { animation: shake-vertical 0.15s infinite alternate; }
        .shaking .stick-group:nth-child(even) { animation-delay: 0.05s; }

        @keyframes shake-vertical {
            0% { transform: translateY(0) rotate(var(--r)); }
            100% { transform: translateY(-35px) rotate(var(--r)); }
        }

        .shaking-cup { animation: shake-cup 0.1s infinite alternate; }
        @keyframes shake-cup {
            from { transform: rotate(-3deg); }
            to { transform: rotate(3deg); }
        }

        /* CUỘN GIẤY & PHÁO HOA */
        #scroll-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        #fireworks-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
        }

        .scroll-wrapper {
            position: relative;
            width: 40px;
            height: 80vh;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: width 1.3s cubic-bezier(0.25, 1, 0.5, 1);
            z-index: 110;
        }

        .scroll-wrapper.open { width: 92vw; max-width: 500px; }

        .scroll-content {
            width: 100%; height: 95%;
            background: var(--paper);
            background-image: url('https://www.transparenttextures.com/patterns/handmade-paper.png');
            border: 10px solid var(--silk);
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
            display: flex; align-items: center; justify-content: center;
            position: relative;
        }

        .scroll-content::after {
            content: ""; position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border: 2px solid var(--red-ancient);
            outline: 3px double var(--red-ancient);
            outline-offset: -12px;
        }

        .wish-text {
            font-family: 'Dancing Script', cursive;
            color: var(--ink);
            font-size: 2.3rem;
            text-align: center;
            white-space: pre-line;
            opacity: 0;
            transition: opacity 0.8s 1s;
        }

        .open .wish-text { opacity: 1; }

        .roller {
            position: absolute; width: 35px; height: 105%;
            background: linear-gradient(to right, #2b1d1a, #5d4037, #2b1d1a);
            border-radius: 4px; z-index: 120;
        }
        .roller.left { left: 0; transform: translateX(-50%); }
        .roller.right { right: 0; transform: translateX(50%); }

        .btn-ui {
            position: relative; z-index: 20;
            margin-top: 30px; padding: 16px 50px;
            background: var(--red-ancient); color: var(--gold);
            border: 2px solid var(--gold); font-weight: bold;
            cursor: pointer; letter-spacing: 3px; text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="container" onclick="startGieo()">
        <img id="cup-back" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
        
        <div class="sticks-container">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -6deg; left: 38%;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -3deg; left: 42%;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 0deg; left: 46%;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 3deg; left: 50%;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 6deg; left: 54%;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -2deg; left: 40%; z-index: 4; margin-bottom: -10px;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 1deg; left: 45%; z-index: 4; margin-bottom: -10px;">
            <img class="stick-group" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 4deg; left: 50%; z-index: 4; margin-bottom: -10px;">
        </div>
        
        <img id="cup-front" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
    </div>

    <button class="btn-ui" id="btnAction">TÂM THÀNH Ý NGUYỆN</button>

    <div id="scroll-overlay" onclick="closeScroll()">
        <canvas id="fireworks-canvas"></canvas>
        <div class="scroll-wrapper" id="scrollWrapper">
            <div class="roller left"></div>
            <div class="scroll-content">
                <div class="wish-text" id="wishDisplay"></div>
            </div>
            <div class="roller right"></div>
        </div>
    </div>

    <audio id="sfx" src="https://www.soundjay.com/misc/sounds/wooden-clatter-1.mp3"></audio>

    <script>
        const wishes = [
            "Mã Đáo Thành Công\nVạn Sự Hanh Thông", "Thiên Ý Cát Tường\nPhú Quý Bình An",
            "Ngũ Phúc Lâm Môn\nĐắc Lộc Toàn Gia", "Công Thành Danh Toại\nSự Nghiệp Thăng Hoa",
            "An Khang Thịnh Vượng\nSức Khỏe Dồi Dào", "Vạn Kỳ Như Ý\nTấn Tài Tấn Lộc",
            "Thân Tâm An Lạc\nTrí Tuệ Minh Mẫn", "Gia Hòa Vạn Sự Hưng\nHạnh Phúc Bền Lâu",
            "Khai Xuân Đại Cát\nThuận Buồm Xuôi Gió", "Phong Thủy Hữu Tình\nTài Lộc Vô Biên",
            "Nhất Phẩm Đương Triều\nDanh Tiếng Vang Xa", "Kim Ngọc Mãn Đường\nPhúc Thọ Song Toàn",
            "Bách Nghiệp Hưng Thịnh\nThời Lai Vận Đáo", "Cung Hỷ Phát Tài\nXuân Phong Đắc Ý",
            "Đức Tài Song Lập\nPhúc Trạch Vĩnh Miên", "Tình Duyên Viên Mãn\nSong Hỷ Lâm Môn",
            "Học Vấn Tinh Thông\nBảng Vàng Đề Tên", "Tiền Trình Tự Cẩm\nRạng Rỡ Tổ Tông",
            "Phúc Tinh Cao Chiếu\nSự Nghiệp Vững Bền", "Vạn Cổ Trường Xuân\nPhú Quý Cát Tường"
        ];

        let active = false;
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function startGieo() {
            if (active) return;
            active = true;
            document.getElementById('btnAction').style.visibility = 'hidden';
            document.getElementById('sfx').play().catch(()=>{});
            
            const container = document.getElementById('container');
            container.classList.add('shaking', 'shaking-cup');

            setTimeout(() => {
                container.classList.remove('shaking', 'shaking-cup');
                openScroll();
            }, 1400);
        }

        function openScroll() {
            const random = wishes[Math.floor(Math.random() * wishes.length)];
            document.getElementById('wishDisplay').innerText = random + "\nBính Ngọ 2026";
            document.getElementById('scroll-overlay').style.display = 'flex';
            resizeCanvas();
            
            setTimeout(() => {
                document.getElementById('scrollWrapper').classList.add('open');
                startFireworks();
            }, 100);
        }

        function closeScroll() {
            document.getElementById('scrollWrapper').classList.remove('open');
            setTimeout(() => {
                document.getElementById('scroll-overlay').style.display = 'none';
                document.getElementById('btnAction').style.visibility = 'visible';
                active = false;
                particles = [];
            }, 800);
        }

        // FIREWORKS LOGIC
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function createParticle(x, y) {
            const colors = ['#ff0', '#f0f', '#0ff', '#f00', '#fff', '#d4af37'];
            for (let i = 0; i < 30; i++) {
                particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    alpha: 1,
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
        }

        function startFireworks() {
            if (!active) return;
            if (Math.random() < 0.1) createParticle(Math.random() * canvas.width, Math.random() * canvas.height);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.alpha -= 0.01;
                ctx.globalAlpha = p.alpha;
                ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI * 2); ctx.fill();
                if (p.alpha <= 0) particles.splice(i, 1);
            });
            requestAnimationFrame(startFireworks);
        }

        document.getElementById('btnAction').onclick = startGieo;
    </script>
</body>
</html>
