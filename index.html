<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·∫Øc Qu·∫ª 3D - Xu√¢n 2026</title>
    <style>
        :root { --gold: #ffd700; --red: #b30000; }
        body {
            margin: 0; background: radial-gradient(circle, #b30000, #4a0000);
            height: 100vh; display: flex; flex-direction: column;
            align-items: center; justify-content: center; overflow: hidden;
            font-family: 'Segoe UI', sans-serif; color: var(--gold);
        }

        /* 1. C·∫•u tr√∫c ·ªëng qu·∫ª 3D */
        #container {
            position: relative; width: 200px; height: 300px;
            perspective: 1000px; cursor: pointer;
        }
        .cup-layer { position: absolute; width: 100%; bottom: 0; }
        #cup-back { z-index: 1; filter: brightness(0.6); }
        #sticks { 
            z-index: 2; bottom: 50px; left: 10%; width: 80%; 
            transition: transform 0.1s; 
        }
        #cup-front { z-index: 3; filter: drop-shadow(0 10px 15px rgba(0,0,0,0.5)); }

        /* 2. Hi·ªáu ·ª©ng th·∫ª qu·∫ª bay ra */
        #single-stick {
            position: fixed; width: 40px; height: 180px;
            background: #f3e5ab; border: 2px solid #8d6e63;
            border-radius: 5px; z-index: 50; display: none;
            color: #b30000; writing-mode: vertical-rl;
            text-align: center; font-weight: bold; padding: 10px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            left: 50%; top: 50%; transform: translate(-50%, -50%);
        }

        /* Animation l·∫Øc */
        .shaking #cup-front, .shaking #cup-back { animation: shake-cup 0.15s infinite; }
        .shaking #sticks { animation: shake-sticks 0.1s infinite; }

        @keyframes shake-cup {
            0% { transform: rotate(2deg); }
            100% { transform: rotate(-2deg); }
        }
        @keyframes shake-sticks {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px) rotate(3deg); }
        }

        /* 3. B·∫£ng k·∫øt qu·∫£ */
        #ket-qua {
            display: none; position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            background: #fffdf0; color: #b30000; padding: 30px;
            border-radius: 15px; border: 5px double #b30000;
            z-index: 100; width: 280px; text-align: center;
            box-shadow: 0 0 100px rgba(0,0,0,0.5);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #ket-qua.show { display: block; transform: translate(-50%, -50%) scale(1); }

        .btn {
            background: var(--gold); color: var(--red);
            border: none; padding: 12px 30px; border-radius: 25px;
            font-weight: bold; cursor: pointer; margin-top: 15px;
        }
    </style>
</head>
<body>

    <h1>üßß XIN QU·∫∫ LINH ·ª®NG üßß</h1>

    <div id="container">
        <img id="cup-back" class="cup-layer" src="https://i.imgur.com/8YlQk6l.png">
        <img id="sticks" class="cup-layer" src="https://i.imgur.com/uX8DkX7.png">
        <img id="cup-front" class="cup-layer" src="https://i.imgur.com/8YlQk6l.png">
    </div>

    <div id="single-stick">C√ÅT T∆Ø·ªúNG</div>

    <p>Ch·∫°m v√†o ·ªëng ho·∫∑c l·∫Øc m√°y ƒë·ªÉ xin qu·∫ª</p>
    <button id="start-btn" class="btn">B·∫ÆT ƒê·∫¶U</button>

    <div id="ket-qua">
        <h2 style="margin-top:0">‚ú® CH√öC M·ª™NG ‚ú®</h2>
        <div id="loi-chuc" style="font-size: 1.2rem; min-height: 60px;"></div>
        <button class="btn" onclick="reset()">Xin qu·∫ª kh√°c</button>
    </div>

    <audio id="sfx" src="https://www.soundjay.com/misc/sounds/wooden-clatter-1.mp3"></audio>

    <script>
        const loiChucs = [
            "üßß Ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc s√¥ng ƒê√†\nTi·ªÅn ra nh·ªè gi·ªçt nh∆∞ c√† ph√™ phin",
            "üå∏ V·∫°n s·ª± nh∆∞ √Ω\nƒê·∫Øc l·ªôc to√†n gia",
            "üí∞ S·ª©c kh·ªèe v√¥ bi√™n\nKi·∫øm ƒë∆∞·ª£c nhi·ªÅu ti·ªÅn",
            "‚ú® T√¨nh duy√™n ph∆°i ph·ªõi\nH·∫°nh ph√∫c ng·∫≠p tr·ªùi"
        ];

        let isShaking = false;
        const container = document.getElementById('container');
        const singleStick = document.getElementById('single-stick');
        const ketQua = document.getElementById('ket-qua');
        const sfx = document.getElementById('sfx');

        // H√†m x·ª≠ l√Ω ch√≠nh
        function startShake() {
            if (isShaking) return;
            isShaking = true;
            container.classList.add('shaking');
            sfx.play();

            setTimeout(() => {
                container.classList.remove('shaking');
                launchStick();
            }, 1500);
        }

        // Hi·ªáu ·ª©ng th·∫ª bay ra
        function launchStick() {
            singleStick.style.display = 'block';
            // Animation bay t·ª´ ·ªëng l√™n trung t√¢m
            singleStick.animate([
                { transform: 'translate(-50%, 100%) rotate(0deg)', opacity: 0 },
                { transform: 'translate(-50%, -50%) rotate(720deg)', opacity: 1 }
            ], { duration: 800, easing: 'ease-out' }).onfinish = () => {
                setTimeout(() => {
                    singleStick.style.display = 'none';
                    showFinalResult();
                }, 600);
            };
        }

        function showFinalResult() {
            document.getElementById('loi-chuc').innerText = loiChucs[Math.floor(Math.random()*loiChucs.length)];
            ketQua.classList.add('show');
        }

        function reset() {
            ketQua.classList.remove('show');
            setTimeout(() => { isShaking = false; }, 500);
        }

        // T∆∞∆°ng t√°c
        container.onclick = startShake;
        document.getElementById('start-btn').onclick = (e) => {
            e.target.style.display = 'none';
            // Xin quy·ªÅn c·∫£m bi·∫øn n·∫øu l√† iOS
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission().then(res => { if(res==='granted') initAcc(); });
            } else { initAcc(); }
        };

        function initAcc() {
            let lastA = 0;
            window.addEventListener('devicemotion', (e) => {
                let a = e.accelerationIncludingGravity;
                let total = Math.abs(a.x + a.y + a.z);
                if (Math.abs(total - lastA) > 15) startShake();
                lastA = total;
            });
        }
    </script>
</body>
</html>
