<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Quẻ Đầu Xuân 2026</title>
    <style>
        :root { 
            --gold-bright: #ffed8a; 
            --gold-dark: #d4af37;
            --red-royal: #8b0000; 
            --bg-paper: #fffcf0; /* Màu giấy xuyến chỉ sang trọng */
        }

        body {
            margin: 0; 
            background: url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/IMG_6492.JPG?raw=true') no-repeat center center fixed;
            background-size: cover;
            height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            overflow: hidden;
            font-family: 'Times New Roman', Times, serif; /* Font chữ có chân cổ điển */
        }

        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        /* 1. Ống quẻ trung tâm */
        #container {
            position: relative; 
            z-index: 2;
            width: 260px; 
            height: 420px;
            perspective: 1200px; 
            cursor: pointer;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .cup-layer { 
            position: absolute; 
            width: 100%; 
            bottom: 0;
            user-select: none;
            pointer-events: none;
        }

        #cup-back { z-index: 1; filter: brightness(0.5); transform: scale(0.97); }
        #sticks {  
            z-index: 2; 
            bottom: 110px; 
            width: 55%; 
            transition: transform 0.1s; 
        }
        #cup-front { 
            z-index: 3; 
            filter: drop-shadow(0 20px 40px rgba(0,0,0,0.8));
        }

        /* 2. Cây quẻ đơn */
        #single-stick {
            position: fixed; 
            width: 65px; 
            z-index: 100; 
            display: none;
            left: 50%; 
            top: 50%; 
            transform: translate(-50%, -50%);
            filter: drop-shadow(0 10px 25px rgba(0,0,0,0.7));
        }

        /* 3. Trang trí xung quanh */
        .decor-stick {
            position: absolute;
            width: 45px;
            opacity: 0.4;
            z-index: 1;
            filter: blur(1.5px);
        }

        /* Animation lắc */
        .shaking #cup-front, .shaking #cup-back { animation: shake-cup 0.1s infinite alternate; }
        .shaking #sticks { animation: shake-sticks 0.08s infinite alternate; }

        @keyframes shake-cup { 0% { transform: rotate(3deg); } 100% { transform: rotate(-3deg); } }
        @keyframes shake-sticks { 0% { transform: translateY(0); } 100% { transform: translateY(-55px) rotate(4deg); } }

        /* 4. Ô vuông kết quả (Canvas sang trọng) */
        #ket-qua {
            display: none; 
            position: fixed; 
            top: 50%; 
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            background: var(--bg-paper); 
            color: var(--red-royal); 
            padding: 40px 30px;
            border-radius: 4px; /* Viền hơi vuông cho phong cách cổ điển */
            border: 2px solid var(--gold-dark);
            outline: 8px double var(--red-royal); /* Viền kép sang trọng */
            outline-offset: -15px;
            z-index: 200; 
            width: 320px; 
            text-align: center;
            box-shadow: 0 0 150px rgba(0,0,0,0.9);
            transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1);
        }

        #ket-qua.show { display: block; transform: translate(-50%, -50%) scale(1); }

        #loi-chuc {
            font-family: 'Segoe UI Historic', 'Georgia', serif; /* Font cổ truyền */
            font-size: 1.4rem; 
            min-height: 90px; 
            padding: 20px 10px; 
            line-height: 1.8;
            font-weight: bold;
            letter-spacing: 1px;
            white-space: pre-line;
        }

        .btn {
            background: var(--red-royal); 
            color: var(--gold-bright);
            border: 1px solid var(--gold-dark); 
            padding: 14px 35px; 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: 25px;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: 0.3s;
        }

        .btn:hover { background: #b30000; letter-spacing: 3px; }

        .instruction {
            position: fixed;
            bottom: 30px;
            color: var(--gold-bright);
            background: rgba(139, 0, 0, 0.6);
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 0.9rem;
            letter-spacing: 1px;
            z-index: 5;
        }
    </style>
</head>
<body>

    <img class="decor-stick" style="top:5%; left:5%; transform:rotate(-20deg)" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">
    <img class="decor-stick" style="top:10%; right:5%; transform:rotate(25deg)" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">
    <img class="decor-stick" style="bottom:5%; left:10%; transform:rotate(15deg)" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">
    <img class="decor-stick" style="bottom:15%; right:8%; transform:rotate(-30deg)" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">

    <div id="container">
        <img id="cup-back" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
        <img id="sticks" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">
        <img id="cup-front" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
    </div>

    <img id="single-stick" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true">

    <div class="instruction">Lắc máy hoặc chạm vào ống để gieo quẻ</div>
    <button id="start-btn" class="btn" style="position: absolute; bottom: 80px;">BẮT ĐẦU</button>

    <div id="ket-qua">
        <div style="font-size: 0.8rem; letter-spacing: 4px; margin-bottom: 5px; opacity: 0.7;">BÍNH NGỌ 2026</div>
        <h2 style="margin-top:0; border-bottom: 1px solid var(--gold-dark); padding-bottom: 10px; font-style: italic;">Phúc Lộc Linh Ứng</h2>
        <div id="loi-chuc"></div>
        <button class="btn" onclick="reset()">Tạ Lễ</button>
    </div>

    <audio id="sfx" src="https://www.soundjay.com/misc/sounds/wooden-clatter-1.mp3"></audio>

    <script>
        const loiChucs = [
            "Mã Đáo Thành Công\nVạn Sự Hanh Thông",
            "Tiền Vô Như Nước\nPhúc Lộc Đầy Nhà",
            "Sức Khỏe Dồi Dào\nAn Khang Thịnh Vượng",
            "Tình Duyên Viên Mãn\nHạnh Phúc Vững Bền",
            "Công Thành Danh Toại\nSự Nghiệp Thăng Hoa",
            "Ngũ Phúc Lâm Môn\nPhú Quý Cát Tường"
        ];

        let isShaking = false;
        const container = document.getElementById('container');
        const singleStick = document.getElementById('single-stick');
        const ketQua = document.getElementById('ket-qua');
        const sfx = document.getElementById('sfx');

        function startShake() {
            if (isShaking) return;
            isShaking = true;
            sfx.currentTime = 0;
            sfx.play();
            container.classList.add('shaking');

            setTimeout(() => {
                container.classList.remove('shaking');
                launchStick();
            }, 1200);
        }

        function launchStick() {
            singleStick.style.display = 'block';
            const anim = singleStick.animate([
                { transform: 'translate(-50%, 80%) scale(0.4) rotate(0deg)', opacity: 0 },
                { transform: 'translate(-50%, -50%) scale(1.6) rotate(1080deg)', opacity: 1 }
            ], { 
                duration: 1300, 
                easing: 'cubic-bezier(0.19, 1, 0.22, 1)',
                fill: 'forwards'
            });

            anim.onfinish = () => {
                setTimeout(() => {
                    singleStick.style.display = 'none';
                    showFinalResult();
                }, 1000);
            };
        }

        function showFinalResult() {
            document.getElementById('loi-chuc').innerText = loiChucs[Math.floor(Math.random()*loiChucs.length)];
            ketQua.classList.add('show');
        }

        function reset() {
            ketQua.classList.remove('show');
            setTimeout(() => { isShaking = false; }, 600);
        }

        container.onclick = startShake;

        document.getElementById('start-btn').onclick = (e) => {
            e.target.style.display = 'none';
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission().then(res => { if(res==='granted') initAcc(); });
            } else { initAcc(); }
        };

        function initAcc() {
            let lastA = 0;
            window.addEventListener('devicemotion', (e) => {
                let a = e.accelerationIncludingGravity;
                if(!a) return;
                let total = Math.abs(a.x + a.y + a.z);
                if (Math.abs(total - lastA) > 22) startShake();
                lastA = total;
            });
        }
    </script>
</body>
</html>
