<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Quẻ Bính Ngọ 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --red-ancient: #8b0000;
        }

        body {
            margin: 0;
            background: #111 url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/IMG_6492.JPG?raw=true') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Segoe UI', serif;
        }

        body::before {
            content: "";
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        /* ỐNG QUẺ - KHÔI PHỤC NGUYÊN BẢN */
        #container {
            position: relative;
            width: 320px;
            height: 480px;
            z-index: 10;
            cursor: pointer;
            display: flex;
            justify-content: center;
        }

        .cup-layer { position: absolute; bottom: 0; width: 100%; pointer-events: none; }
        #cup-back { z-index: 1; filter: brightness(0.3); }
        #cup-front { z-index: 5; filter: drop-shadow(0 15px 40px rgba(0,0,0,0.8)); }

        .sticks-bundle {
            position: absolute;
            bottom: 225px; 
            left: 38%; 
            transform: translateX(-50%);
            width: 66px; 
            height: 200px;
            z-index: 3;
            display: flex;
            justify-content: center;
        }

        .stick-item {
            position: absolute;
            width: 95px; 
            filter: brightness(0.85) contrast(1.1);
            bottom: 0;
        }

        /* HIỆU ỨNG LẮC */
        .shaking .stick-item { animation: shake-h 0.12s infinite alternate; }
        @keyframes shake-h {
            0% { transform: translateX(-10px) rotate(var(--r)); }
            100% { transform: translateX(10px) rotate(var(--r)); }
        }
        .shaking-cup { animation: cup-vibrate 0.1s infinite alternate; }
        @keyframes cup-vibrate { from { transform: rotate(-3deg); } to { transform: rotate(3deg); } }

        /* LIỄN FULL MÀN HÌNH */
        #scroll-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .lien-wrapper {
            position: relative;
            width: 90vw;
            max-width: 500px;
            height: 0;
            overflow: hidden;
            transition: height 1.5s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 0 60px rgba(0,0,0,0.8);
        }

        .lien-bg {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 90vh;
            background: url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/nen%20chu%20chuc%20tet.png?raw=true') no-repeat center top;
            background-size: 100% 100%;
        }

        .lien-wrapper.open { height: 90vh; }

        /* CHỮ VÀNG ÁNH KIM VÀ VỊ TRÍ THẤP */
        .wish-text {
            position: relative;
            z-index: 2;
            font-family: 'Dancing Script', cursive;
            background: linear-gradient(to bottom, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.6rem;
            text-align: center;
            white-space: pre-line;
            opacity: 0;
            padding-top: 380px; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            transition: opacity 0.8s 1.2s;
        }
        .open .wish-text { opacity: 1; }

        .btn-ui {
            position: relative; z-index: 20;
            margin-top: 30px; padding: 18px 60px;
            background: var(--red-ancient); color: var(--gold);
            border: 2px solid var(--gold); font-weight: bold;
            cursor: pointer; letter-spacing: 2px;
        }

        #fireworks-canvas {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%; pointer-events: none;
        }
    </style>
</head>
<body>

    <audio id="bgMusic" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/raw/refs/heads/main/fassounds-chinese-new-year-celebration-473044%20(mp3cut.net).mp3" loop preload="auto"></audio>

    <div id="container" onclick="startGieo()">
        <img id="cup-back" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
        <div class="sticks-bundle">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -8deg; left: 0%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -4deg; left: 15%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 0deg; left: 30%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 4deg; left: 45%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 8deg; left: 60%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -2deg; left: 15%; z-index: 4; margin-bottom: -8px;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 2deg; left: 38%; z-index: 4; margin-bottom: -8px;">
        </div>
        <img id="cup-front" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
    </div>

    <button class="btn-ui" id="btnAction" onclick="startGieo()">TÂM THÀNH Ý NGUYỆN</button>

    <div id="scroll-overlay" onclick="closeScroll()">
        <canvas id="fireworks-canvas"></canvas>
        <div class="lien-wrapper" id="lienWrapper">
            <div class="lien-bg"></div>
            <div class="wish-text" id="wishDisplay"></div>
        </div>
    </div>

    <script>
        const wishes = [
            "Ăn nhiều không béo\nNợ nần tự héo\nVí tiền dẻo dai",
            "Da đẹp như tiên\nTiền đầy như biển\nVạn sự bình yên",
            "Ăn ngon không mập\nNgủ kỹ không muộn\nMuộn phiền tự tan",
            "Cuộc sống nở hoa\nDrama không có\nVí tiền tự to",
            "Tâm an thân khỏe\nChẳng chút ưu phiền\nVui vẻ như tiên",
            "Vàng ròng đầy tủ\nKim cương đầy khay\nLộc về đầy tay",
            "Đầu tư là trúng\nBốc quẻ là giàu\nTiền tiêu không hết",
            "Thần Tài gõ cửa\nPhú quý vây quanh\nTài lộc tươi xanh",
            "Vạn sự như ý\nTỷ sự như mơ\nTriệu điều bất ngờ",
            "Sức khỏe dẻo dai\nPhong độ bất bại\nTinh thần xanh tươi"
        ];

        let active = false;
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function startGieo() {
            if (active) return;
            active = true;
            document.getElementById('btnAction').style.visibility = 'hidden';
            
            // Ở đây bạn có thể thêm lệnh phát tiếng "Lắc quẻ cọc cạch"
            // Ví dụ: soundLacQue.play();

            const container = document.getElementById('container');
            container.classList.add('shaking', 'shaking-cup');

            setTimeout(() => {
                container.classList.remove('shaking', 'shaking-cup');
                openScroll();
            }, 1500); // 1.5 giây lắc quẻ cọc cạch
        }

        function openScroll() {
            // NHẠC NỀN PHÁT TẠI ĐÂY - LÚC TẤM LIỄN BẮT ĐẦU BAY LÊN
            const music = document.getElementById('bgMusic');
            music.currentTime = 0; 
            music.volume = 0.5;
            music.play().catch(()=>{});

            const random = wishes[Math.floor(Math.random() * wishes.length)];
            document.getElementById('wishDisplay').innerText = random;
            document.getElementById('scroll-overlay').style.display = 'flex';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            setTimeout(() => {
                document.getElementById('lienWrapper').classList.add('open');
                animateFireworks();
            }, 100);
        }

        function closeScroll() {
            // Dừng nhạc khi đóng liễn để lần sau phát lại từ đầu
            const music = document.getElementById('bgMusic');
            music.pause();

            document.getElementById('lienWrapper').classList.remove('open');
            setTimeout(() => {
                document.getElementById('scroll-overlay').style.display = 'none';
                document.getElementById('btnAction').style.visibility = 'visible';
                active = false;
                particles = [];
            }, 800);
        }

        function createParticle(x, y) {
            const colors = ['#FFD700', '#FF4500', '#FF69B4', '#00FFFF', '#ADFF2F'];
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x, y, vx: (Math.random() - 0.5) * 10, vy: (Math.random() - 0.5) * 10,
                    alpha: 1, color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
        }

        function animateFireworks() {
            if (!active) return;
            if (Math.random() < 0.05) createParticle(Math.random() * canvas.width, Math.random() * canvas.height);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.alpha -= 0.012;
                ctx.globalAlpha = p.alpha;
                ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI * 2); ctx.fill();
                if (p.alpha <= 0) particles.splice(i, 1);
            });
            requestAnimationFrame(animateFireworks);
        }
    </script>
</body>
</html>
