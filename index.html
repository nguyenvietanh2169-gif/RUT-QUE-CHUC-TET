<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Quẻ Bính Ngọ 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --red-ancient: #8b0000;
        }

        body {
            margin: 0;
            background: #111 url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/IMG_6492.JPG?raw=true') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Segoe UI', serif;
        }

        body::before {
            content: "";
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        /* ỐNG QUẺ - GIỮ NGUYÊN VỊ TRÍ CŨ */
        #container {
            position: relative;
            width: 320px;
            height: 480px;
            z-index: 10;
            cursor: pointer;
            display: flex;
            justify-content: center;
        }

        .cup-layer { position: absolute; bottom: 0; width: 100%; pointer-events: none; }
        #cup-back { z-index: 1; filter: brightness(0.3); }
        #cup-front { z-index: 5; filter: drop-shadow(0 15px 40px rgba(0,0,0,0.8)); }

        .sticks-bundle {
            position: absolute;
            bottom: 225px; 
            left: 38%; 
            transform: translateX(-50%);
            width: 66px; 
            height: 200px;
            z-index: 3;
            display: flex;
            justify-content: center;
        }

        .stick-item {
            position: absolute;
            width: 95px; 
            filter: brightness(0.85) contrast(1.1);
            bottom: 0;
        }

        /* LẮC QUẺ */
        .shaking .stick-item { animation: shake-h 0.12s infinite alternate; }
        @keyframes shake-h {
            0% { transform: translateX(-10px) rotate(var(--r)); }
            100% { transform: translateX(10px) rotate(var(--r)); }
        }
        .shaking-cup { animation: cup-vibrate 0.1s infinite alternate; }
        @keyframes cup-vibrate { from { transform: rotate(-3deg); } to { transform: rotate(3deg); } }

        /* HIỆU ỨNG LIỄN CUỘN DỌC */
        #scroll-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .lien-wrapper {
            position: relative;
            width: 300px; /* Độ rộng liễn */
            height: 0; /* Bắt đầu bằng 0 để cuộn xuống */
            background: url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/nen%20chu%20chuc%20tet.png?raw=true') no-repeat center top;
            background-size: 100% 100%;
            transition: height 1.5s cubic-bezier(0.23, 1, 0.32, 1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        .lien-wrapper.open {
            height: 550px; /* Chiều cao khi mở hết liễn */
        }

        .wish-text {
            font-family: 'Dancing Script', cursive;
            color: #ffeb3b; /* Màu vàng thư pháp */
            font-size: 2.2rem;
            text-align: center;
            white-space: pre-line;
            opacity: 0;
            padding: 0 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            transition: opacity 0.8s 1.2s;
        }
        .open .wish-text { opacity: 1; }

        .btn-ui {
            position: relative; z-index: 20;
            margin-top: 30px; padding: 18px 60px;
            background: var(--red-ancient); color: var(--gold);
            border: 2px solid var(--gold); font-weight: bold;
            cursor: pointer; letter-spacing: 2px;
        }

        #fireworks-canvas {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%; pointer-events: none;
        }
    </style>
</head>
<body>

    <audio id="bgMusic" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/raw/refs/heads/main/fassounds-chinese-new-year-celebration-473044%20(mp3cut.net).mp3" loop preload="auto"></audio>

    <div id="container" onclick="startGieo()">
        <img id="cup-back" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
        <div class="sticks-bundle">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -8deg; left: 0%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -4deg; left: 15%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 0deg; left: 30%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 4deg; left: 45%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 8deg; left: 60%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -2deg; left: 15%; z-index: 4; margin-bottom: -8px;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 2deg; left: 38%; z-index: 4; margin-bottom: -8px;">
        </div>
        <img id="cup-front" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
    </div>

    <button class="btn-ui" id="btnAction" onclick="startGieo()">TÂM THÀNH Ý NGUYỆN</button>

    <div id="scroll-overlay" onclick="closeScroll()">
        <canvas id="fireworks-canvas"></canvas>
        <div class="lien-wrapper" id="lienWrapper">
            <div class="wish-text" id="wishDisplay"></div>
        </div>
    </div>

    <script>
        const wishes = [
            "Mã Đáo Thành Công\nVạn Sự Hanh Thông", "Thiên Ý Cát Tường\nPhú Quý Bình An",
            "Ngũ Phúc Lâm Môn\nĐắc Lộc Toàn Gia", "Công Thành Danh Toại\nSự Nghiệp Thăng Hoa",
            "An Khang Thịnh Vượng\nSức Khỏe Dồi Dào", "Vạn Kỳ Như Ý\nTấn Tài Tấn Lộc",
            "Thân Tâm An Lạc\nTrí Tuệ Minh Mẫn", "Gia Hòa Vạn Sự Hưng\nHạnh Phúc Bền Lâu",
            "Khai Xuân Đại Cát\nThuận Buồm Xuôi Gió", "Phong Thủy Hữu Tình\nTài Lộc Vô Biên"
        ];

        let active = false;
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function startGieo() {
            if (active) return;
            active = true;
            document.getElementById('btnAction').style.visibility = 'hidden';
            
            // Nhạc nền
            const music = document.getElementById('bgMusic');
            music.volume = 0.5;
            music.play().catch(()=>{});

            const container = document.getElementById('container');
            container.classList.add('shaking', 'shaking-cup');

            setTimeout(() => {
                container.classList.remove('shaking', 'shaking-cup');
                openScroll();
            }, 1500);
        }

        function openScroll() {
            const random = wishes[Math.floor(Math.random() * wishes.length)];
            document.getElementById('wishDisplay').innerText = random + "\nBính Ngọ 2026";
            document.getElementById('scroll-overlay').style.display = 'flex';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            setTimeout(() => {
                document.getElementById('lienWrapper').classList.add('open');
                animateFireworks();
            }, 100);
        }

        function closeScroll() {
            document.getElementById('lienWrapper').classList.remove('open');
            setTimeout(() => {
                document.getElementById('scroll-overlay').style.display = 'none';
                document.getElementById('btnAction').style.visibility = 'visible';
                active = false;
                particles = [];
            }, 800);
        }

        // FIREWORKS LOGIC
        function createParticle(x, y) {
            const colors = ['#FFD700', '#FF4500', '#FF69B4', '#00FFFF', '#ADFF2F'];
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x, y, vx: (Math.random() - 0.5) * 10, vy: (Math.random() - 0.5) * 10,
                    alpha: 1, color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
        }

        function animateFireworks() {
            if (!active) return;
            if (Math.random() < 0.05) createParticle(Math.random() * canvas.width, Math.random() * canvas.height);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.alpha -= 0.012;
                ctx.globalAlpha = p.alpha;
                ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI * 2); ctx.fill();
                if (p.alpha <= 0) particles.splice(i, 1);
            });
            requestAnimationFrame(animateFireworks);
        }
    </script>
</body>
</html>
