<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gieo Quẻ Bính Ngọ 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Charm:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --red-ancient: #8b0000;
        }

        body {
            margin: 0;
            background: #111 url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/IMG_6492.JPG?raw=true') no-repeat center center fixed;
            background-size: cover;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Segoe UI', serif;
        }

        body::before {
            content: "";
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 0;
        }

        /* ỐNG QUẺ */
        #container {
            position: relative;
            width: 320px;
            height: 480px;
            z-index: 10;
            cursor: pointer;
            display: flex;
            justify-content: center;
        }

        .cup-layer { position: absolute; bottom: 0; width: 100%; pointer-events: none; }
        #cup-back { z-index: 1; filter: brightness(0.3); }
        #cup-front { z-index: 5; filter: drop-shadow(0 15px 40px rgba(0,0,0,0.8)); }

        .sticks-bundle {
            position: absolute;
            bottom: 225px; 
            left: 38%; 
            transform: translateX(-50%);
            width: 80px; 
            height: 200px;
            z-index: 3;
        }

        .stick-item {
            position: absolute;
            width: 95px; 
            filter: brightness(0.85) contrast(1.1);
            bottom: 0;
            transform-origin: bottom center;
            transform: rotate(var(--r));
        }

        /* HIỆU ỨNG LẮC LOẠN XẠ (HẾT ĐƠ) */
        .shaking .stick-item {
            animation: messy-shake var(--t) infinite ease-in-out alternate;
        }

        @keyframes messy-shake {
            0% { 
                transform: rotate(calc(var(--r) - 6deg)) translateY(0px) translateX(-2px); 
            }
            50% { 
                transform: rotate(calc(var(--r) + 8deg)) translateY(-15px) translateX(3px); 
            }
            100% { 
                transform: rotate(calc(var(--r) - 4deg)) translateY(-5px) translateX(-1px); 
            }
        }

        /* Rung cả ống quẻ */
        .shaking-cup { animation: cup-vibrate 0.15s infinite; }
        @keyframes cup-vibrate {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            20% { transform: translate(-2px, 0px) rotate(-2deg); }
            40% { transform: translate(2px, -1px) rotate(2deg); }
            60% { transform: translate(-1px, 2px) rotate(-1deg); }
            80% { transform: translate(1px, -2px) rotate(1deg); }
            100% { transform: translate(1px, 1px) rotate(0deg); }
        }

        /* LIỄN ĐỎ */
        #scroll-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        #glitter-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; pointer-events: none;
        }

        .lien-wrapper {
            position: relative;
            z-index: 10;
            width: 90vw;
            max-width: 500px;
            height: 0;
            overflow: hidden;
            transition: height 1.2s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .lien-bg {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 90vh;
            background: url('https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/background%20loi%20chuc%20(1)%20(1).png?raw=true') no-repeat center top;
            background-size: 100% 100%;
        }

        .lien-wrapper.open { height: 90vh; }

        .wish-text {
            position: relative;
            z-index: 11;
            font-family: 'Charm', cursive;
            background: linear-gradient(to bottom, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.2rem;
            text-align: center;
            white-space: pre-line;
            opacity: 0;
            padding-top: 280px; 
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
            transition: opacity 0.8s 1s;
        }
        .open .wish-text { opacity: 1; }

        .btn-ui {
            position: relative; z-index: 20;
            margin-top: 30px; padding: 18px 60px;
            background: var(--red-ancient); color: var(--gold);
            border: 2px solid var(--gold); font-weight: bold;
            cursor: pointer; letter-spacing: 2px; border-radius: 5px;
        }
    </style>
</head>
<body>

    <audio id="bgMusic" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/raw/refs/heads/main/nhac%20tet.mp3" loop preload="auto"></audio>
    <audio id="lacQueSound" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/raw/refs/heads/main/%C4%90u%CC%9Bo%CC%9B%CC%80ng%20An%20Chu%208_Audio%20Denoise%20(mp3cut.net).mp3" preload="auto"></audio>

    <div id="container" onclick="requestPermission()">
        <img id="cup-back" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
        <div class="sticks-bundle">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -12deg; --t: 0.2s; left: 0%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -6deg; --t: 0.35s; left: 10%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 0deg; --t: 0.25s; left: 25%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 8deg; --t: 0.4s; left: 40%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 15deg; --t: 0.3s; left: 55%;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: -4deg; --t: 0.22s; left: 15%; z-index: 4; margin-bottom: -5px;">
            <img class="stick-item" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/que.png?raw=true" style="--r: 5deg; --t: 0.31s; left: 35%; z-index: 4; margin-bottom: -5px;">
        </div>
        <img id="cup-front" class="cup-layer" src="https://github.com/nguyenvietanh2169-gif/RUT-QUE-CHUC-TET/blob/main/ong%20que.png?raw=true">
    </div>

    <button class="btn-ui" id="btnAction" onclick="requestPermission()">TÂM THÀNH Ý NGUYỆN</button>

    <div id="scroll-overlay" onclick="closeScroll()">
        <canvas id="glitter-canvas"></canvas>
        <div class="lien-wrapper" id="lienWrapper">
            <div class="lien-bg"></div>
            <div class="wish-text" id="wishDisplay"></div>
        </div>
    </div>

    <script>
        const wishes = [
            "Ăn nhiều không béo\nNợ nần tự héo\nVí tiền dẻo dai",
            "Da đẹp như tiên\nTiền đầy như biển\nVạn sự bình yên\nKhông có gì phiền",
            "Ăn ngon không mập\nNgủ kỹ không muộn\nMuộn phiền tự tan",
            "Cuộc sống nở hoa\nDrama không có\nVí tiền tự to",
            "Tâm an thân khỏe\nSống vui sống khoẻ\nNhư tiên trên đời",
            "Vàng ròng đầy tủ\nKim cương đầy khay\nTiền về đầy tay",
            "Đầu tư là trúng\nBốc quẻ là giàu\nTiền tiêu không hết",
            "Thần Tài gõ cửa\nPhú quý vây quanh\nTài lộc tươi xanh",
            "Vạn sự như ý\nTỷ sự như mơ\nTriệu điều bất ngờ"
        ];

        let active = false;
        const canvas = document.getElementById('glitter-canvas');
        const ctx = canvas.getContext('2d');
        let points = [];

        function requestPermission() {
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission().then(res => {
                    if (res == 'granted') window.addEventListener('devicemotion', handleMotion);
                });
            } else { window.addEventListener('devicemotion', handleMotion); }
            startGieo();
        }

        function handleMotion(event) {
            if (active) return;
            let acc = event.accelerationIncludingGravity;
            let speed = Math.abs(acc.x + acc.y + acc.z);
            if (speed > 22) startGieo();
        }

        function startGieo() {
            if (active) return;
            active = true;
            document.getElementById('btnAction').style.visibility = 'hidden';
            document.getElementById('lacQueSound').play().catch(()=>{});
            document.getElementById('container').classList.add('shaking', 'shaking-cup');
            setTimeout(() => {
                document.getElementById('container').classList.remove('shaking', 'shaking-cup');
                openScroll();
            }, 1800);
        }

        function openScroll() {
            document.getElementById('bgMusic').play().catch(()=>{});
            document.getElementById('wishDisplay').innerText = wishes[Math.floor(Math.random() * wishes.length)];
            document.getElementById('scroll-overlay').style.display = 'flex';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initGlitter();
            setTimeout(() => {
                document.getElementById('lienWrapper').classList.add('open');
                animateGlitter();
            }, 100);
        }

        function closeScroll() {
            document.getElementById('bgMusic').pause();
            document.getElementById('lienWrapper').classList.remove('open');
            setTimeout(() => {
                document.getElementById('scroll-overlay').style.display = 'none';
                document.getElementById('btnAction').style.visibility = 'visible';
                active = false;
                points = [];
            }, 800);
        }

        function initGlitter() {
            for(let i=0; i<60; i++) {
                points.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2 + 1,
                    speed: Math.random() * 1 + 0.5,
                    opacity: Math.random()
                });
            }
        }

        function animateGlitter() {
            if (!active) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#FFD700";
            points.forEach(p => {
                p.y += p.speed;
                if (p.y > canvas.height) p.y = -10;
                ctx.globalAlpha = Math.abs(Math.sin(Date.now() * 0.001 + p.x));
                ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill();
            });
            requestAnimationFrame(animateGlitter);
        }
    </script>
</body>
</html>
